import{d as J,u as K,r,j as e}from"./index-DUI0rN9s.js";import{G as O}from"./iconBase-BIbUqick.js";function Q(c){return O({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},child:[]}]})(c)}function C(c){return O({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"16 16 12 12 8 16"},child:[]},{tag:"line",attr:{x1:"12",y1:"12",x2:"12",y2:"21"},child:[]},{tag:"path",attr:{d:"M20.39 18.39A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.3"},child:[]},{tag:"polyline",attr:{points:"16 16 12 12 8 16"},child:[]}]})(c)}const ee=()=>{var T;const c=J();K();const[l,I]=r.useState(((T=c.state)==null?void 0:T.editId)||null),[j,m]=r.useState(""),[b,x]=r.useState(null),[w,p]=r.useState(null),[v,h]=r.useState(""),[N,f]=r.useState(""),[u,S]=r.useState(""),[s,g]=r.useState([{subtitle:"",image:null,imagePreview:null,imageName:"",description:""},{subtitle:"",image:null,imagePreview:null,imageName:"",description:""},{subtitle:"",image:null,imagePreview:null,imageName:"",description:""}]),[F,X]=r.useState(!1),[B,Y]=r.useState(null);r.useEffect(()=>{l||(m(""),f(""),x(null),p(null),h(""),g([{subtitle:"",image:null,imagePreview:null,imageName:"",description:""},{subtitle:"",image:null,imagePreview:null,imageName:"",description:""},{subtitle:"",image:null,imagePreview:null,imageName:"",description:""}]),S(""))},[l]);const R=t=>{I(t.id),m(t.mainTitle||""),f(t.mainDescription||""),h(""),p(t.mainImage||null),x(null),g([...[0,1,2].map(i=>{var n,o,M,q,A,U;return{subtitle:((o=(n=t.subSections)==null?void 0:n[i])==null?void 0:o.title)||"",image:null,imagePreview:((q=(M=t.subSections)==null?void 0:M[i])==null?void 0:q.image)||null,imageName:"",description:((U=(A=t.subSections)==null?void 0:A[i])==null?void 0:U.description)||""}})]);let a="";t.addingDate&&(typeof t.addingDate=="object"&&t.addingDate.seconds?a=new Date(t.addingDate.seconds*1e3).toISOString().split("T")[0]:typeof t.addingDate=="string"&&(a=t.addingDate.split("T")[0])),S(a)},[D,P]=r.useState(!0),[E,$]=r.useState({}),[G,k]=r.useState(!1);r.useEffect(()=>{D&&(k(!0),fetch("/getbloglist").then(t=>t.json()).then(t=>{const i={"Latest Blogs":t.slice(0,4)};$(i),k(!1)}).catch(()=>k(!1)))},[D]);const z=t=>{const a=t.target.files[0];a&&(x(a),p(URL.createObjectURL(a)),h(a.name))},y=(t,a,i)=>{g(n=>{const o=[...n];return o[t][a]=i,o})},L=(t,a)=>{const i=a.target.files[0];i&&g(n=>{const o=[...n];return o[t].image=i,o[t].imagePreview=URL.createObjectURL(i),o[t].imageName=i.name,o})},[H,d]=r.useState(!1),W=async t=>{t.preventDefault(),d(!0);try{console.log("Submitting new blog.");const a=new FormData;a.append("mainTitle",j),a.append("mainDescription",N),b&&a.append("mainImage",b),a.append("subTitle1",s[0].subtitle),a.append("subDescription1",s[0].description),s[0].image&&a.append("subImage1",s[0].image),a.append("subTitle2",s[1].subtitle),a.append("subDescription2",s[1].description),s[1].image&&a.append("subImage2",s[1].image),a.append("subTitle3",s[2].subtitle),a.append("subDescription3",s[2].description),s[2].image&&a.append("subImage3",s[2].image),u&&a.append("addingDate",u);const i=await fetch("/insertBlogContent",{method:"POST",body:a});if(!i.ok){const n=await i.text();throw console.error("Blog submit failed:",n),new Error(n||"Failed to submit blog")}alert("Blog submitted successfully!"),d(!1)}catch(a){d(!1),console.error("Error submitting blog:",a),alert("Error submitting blog: "+a.message)}},V=async t=>{t.preventDefault(),d(!0);try{if(!l)return;console.log("Submitting edited blog.");const a=new FormData;a.append("mainTitle",j),a.append("mainDescription",N),b&&a.append("mainImage",b),a.append("subTitle1",s[0].subtitle),a.append("subDescription1",s[0].description),s[0].image&&a.append("subImage1",s[0].image),a.append("subTitle2",s[1].subtitle),a.append("subDescription2",s[1].description),s[1].image&&a.append("subImage2",s[1].image),a.append("subTitle3",s[2].subtitle),a.append("subDescription3",s[2].description),s[2].image&&a.append("subImage3",s[2].image),u&&a.append("addingDate",u);const i=await fetch(`/blog/${l}`,{method:"PUT",body:a});if(!i.ok){const n=await i.text();throw console.error("Blog edit failed:",n),new Error(n||"Failed to update blog")}alert("Blog updated successfully!"),d(!1)}catch(a){d(!1),console.error("Error editing blog:",a),alert("Error editing blog: "+a.message)}};return l&&F?e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center text-white text-xl",children:"Loading blog for editing..."}):l&&B?e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center text-red-400 text-xl",children:B}):e.jsxs("div",{className:"min-h-screen bg-gray-900 py-8 w-full relative",children:[H&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("svg",{className:"animate-spin h-16 w-16 text-blue-400 mb-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),e.jsx("div",{className:"text-white text-xl font-bold",children:"Please wait..."})]})}),e.jsxs("div",{className:"w-full bg-gray-800 rounded-2xl shadow-xl p-10 border border-gray-700 animate-fade-in",children:[e.jsx("div",{className:"flex justify-center mb-8",children:e.jsxs("div",{className:"flex rounded-xl overflow-hidden border-2 border-blue-700 bg-gray-900",children:[e.jsx("button",{type:"button",className:`px-8 py-3 font-bold text-lg transition-all duration-200 focus:outline-none ${l?"bg-gray-900 text-blue-300 hover:bg-blue-800 hover:text-white":"bg-blue-700 text-white"}`,disabled:!l,onClick:()=>{P(!1),I(null),m(""),f(""),x(null),p(null),h(""),g([{subtitle:"",image:null,imagePreview:null,imageName:"",description:""},{subtitle:"",image:null,imagePreview:null,imageName:"",description:""},{subtitle:"",image:null,imagePreview:null,imageName:"",description:""}])},children:"Add Blog"}),e.jsx("button",{type:"button",className:`px-8 py-3 font-bold text-lg transition-all duration-200 focus:outline-none ${l?"bg-blue-700 text-white":"bg-gray-900 text-blue-300 hover:bg-blue-800 hover:text-white"}`,disabled:!!l,onClick:()=>P(t=>!t),children:"Edit Blog"})]})}),D&&e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"bg-gray-700 rounded-xl p-6 shadow border border-blue-700",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Uploaded Blogs"}),G?e.jsx("div",{className:"text-gray-300",children:"Loading blogs..."}):Object.keys(E).length===0?e.jsx("div",{className:"text-gray-400",children:"No blogs found."}):Object.entries(E).map(([t,a])=>e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"font-bold text-lg text-blue-300 mb-2",children:t}),e.jsx("ul",{className:"space-y-2",children:a.map(i=>{var n;return e.jsxs("li",{className:"bg-white rounded-lg shadow p-4 flex items-center justify-between border border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-base",children:i.mainTitle}),e.jsxs("div",{className:"text-gray-500 text-xs line-clamp-1",children:[(n=i.mainDescription)==null?void 0:n.slice(0,80),"..."]})]}),e.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-bold ml-4",onClick:()=>R(i),children:"Edit"})]},i.id)})})]},t)),e.jsx("div",{className:"text-xs text-gray-400 mt-2",children:"Click 'Edit' on a blog to load it for editing."})]})}),e.jsx("div",{className:"flex items-center justify-center mb-8",children:e.jsx("span",{className:"bg-gradient-to-r from-blue-700 to-blue-400 p-4 rounded-full shadow",children:e.jsx(Q,{className:"text-4xl text-white"})})}),e.jsx("h2",{className:"text-3xl font-bold text-center text-white mb-2 tracking-tight font-serif",children:l?"Edit Blog":"Add New Blog"}),e.jsx("p",{className:"text-center text-gray-300 mb-8 font-normal",children:l?"Update the details below to edit the blog post.":"Fill in the details below to create a new blog post."}),e.jsxs("form",{onSubmit:W,className:"",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block font-semibold mb-2 text-gray-200",children:"Adding Date (optional)"}),e.jsx("input",{type:"date",className:"w-full border border-gray-700 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-600 bg-gray-700 text-white transition-all duration-200 shadow-sm placeholder-gray-400",value:u,onChange:t=>S(t.target.value)}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"If left empty, the current date will be used."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10",children:[e.jsxs("div",{className:"flex flex-col gap-8 justify-start",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-2 text-gray-200",children:"Main Title"}),e.jsx("input",{type:"text",className:"w-full border border-gray-700 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-600 bg-gray-700 text-white transition-all duration-200 shadow-sm placeholder-gray-400",value:j,onChange:t=>m(t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-2 text-gray-200",children:"Main Image"}),e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-gray-600 rounded-xl cursor-pointer bg-gray-900 hover:bg-gray-800 transition group",children:[e.jsx(C,{className:"text-3xl text-blue-400 mb-2 group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-gray-400 font-medium",children:"Click to upload"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:z,required:!l})]}),v&&e.jsxs("div",{className:"mt-2 text-sm text-gray-400",children:["Selected: ",e.jsx("span",{className:"font-semibold text-gray-200",children:v})]}),!v&&w&&l&&e.jsx("div",{className:"mt-2 text-sm text-gray-400",children:"Current image in use"}),w&&e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx("div",{className:"rounded-xl overflow-hidden shadow border border-gray-700 bg-gray-900 w-60",children:e.jsx("img",{src:w,alt:"Main Preview",className:"h-40 w-full object-cover hover:scale-105 transition-transform duration-300"})})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-2 text-gray-200",children:"Main Description"}),e.jsx("textarea",{className:"w-full border border-gray-700 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-600 bg-gray-700 text-white transition-all duration-200 shadow-sm placeholder-gray-400",rows:4,value:N,onChange:t=>f(t.target.value),required:!0})]})]}),e.jsxs("div",{className:"flex flex-col gap-8 justify-start",children:[e.jsxs("div",{className:"bg-gray-800 rounded-2xl p-6 shadow border border-gray-700 animate-fade-in-up",children:[e.jsx("h3",{className:"font-semibold mb-3 text-lg text-white font-serif",children:"Subtitle 1"}),e.jsx("input",{type:"text",className:"w-full border border-gray-700 rounded-lg px-3 py-2 mb-3 focus:outline-none focus:ring-2 focus:ring-blue-600 bg-gray-700 text-white transition-all duration-200 shadow-sm placeholder-gray-400",placeholder:"Subtitle 1",value:s[0].subtitle,onChange:t=>y(0,"subtitle",t.target.value),required:!0}),e.jsx("label",{className:"block font-semibold mb-2 text-gray-200",children:"Subtitle Image"}),e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-28 border-2 border-dashed border-gray-600 rounded-xl cursor-pointer bg-gray-900 hover:bg-gray-800 transition group",children:[e.jsx(C,{className:"text-2xl text-blue-400 mb-1 group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-gray-400 font-medium text-sm",children:"Click to upload"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:t=>L(0,t),required:!l})]}),s[0].imageName&&e.jsxs("div",{className:"mt-1 text-xs text-gray-400",children:["Selected: ",e.jsx("span",{className:"font-semibold text-gray-200",children:s[0].imageName})]}),!s[0].imageName&&s[0].imagePreview&&l&&e.jsx("div",{className:"mt-1 text-xs text-gray-400",children:"Current image in use"}),s[0].imagePreview&&e.jsx("div",{className:"mt-3 flex justify-center",children:e.jsx("div",{className:"rounded-lg overflow-hidden shadow border border-gray-700 bg-gray-900 w-44",children:e.jsx("img",{src:s[0].imagePreview,alt:"Subtitle 1 Preview",className:"h-28 w-full object-cover hover:scale-105 transition-transform duration-300"})})}),e.jsx("label",{className:"block font-semibold mb-2 text-gray-200 mt-3",children:"Subtitle Description"}),e.jsx("textarea",{className:"w-full border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 bg-gray-700 text-white transition-all duration-200 shadow-sm placeholder-gray-400",rows:2,value:s[0].description,onChange:t=>y(0,"description",t.target.value),required:!0})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[1,2].map(t=>e.jsxs("div",{className:"bg-gray-800 rounded-2xl p-6 shadow border border-gray-700 animate-fade-in-up",children:[e.jsxs("h3",{className:"font-semibold mb-3 text-lg text-white font-serif",children:["Subtitle ",t+1]}),e.jsx("input",{type:"text",className:"w-full border border-gray-700 rounded-lg px-3 py-2 mb-3 focus:outline-none focus:ring-2 focus:ring-blue-600 bg-gray-700 text-white transition-all duration-200 shadow-sm placeholder-gray-400",placeholder:`Subtitle ${t+1}`,value:s[t].subtitle,onChange:a=>y(t,"subtitle",a.target.value),required:!0}),e.jsx("label",{className:"block font-semibold mb-2 text-gray-200",children:"Subtitle Image"}),e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-28 border-2 border-dashed border-gray-600 rounded-xl cursor-pointer bg-gray-900 hover:bg-gray-800 transition group",children:[e.jsx(C,{className:"text-2xl text-blue-400 mb-1 group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-gray-400 font-medium text-sm",children:"Click to upload"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:a=>L(t,a),required:!l})]}),s[t].imageName&&e.jsxs("div",{className:"mt-1 text-xs text-gray-400",children:["Selected: ",e.jsx("span",{className:"font-semibold text-gray-200",children:s[t].imageName})]}),!s[t].imageName&&s[t].imagePreview&&l&&e.jsx("div",{className:"mt-1 text-xs text-gray-400",children:"Current image in use"}),s[t].imagePreview&&e.jsx("div",{className:"mt-3 flex justify-center",children:e.jsx("div",{className:"rounded-lg overflow-hidden shadow border border-gray-700 bg-gray-900 w-44",children:e.jsx("img",{src:s[t].imagePreview,alt:`Subtitle ${t+1} Preview`,className:"h-28 w-full object-cover hover:scale-105 transition-transform duration-300"})})}),e.jsx("label",{className:"block font-semibold mb-2 text-gray-200 mt-3",children:"Subtitle Description"}),e.jsx("textarea",{className:"w-full border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 bg-gray-700 text-white transition-all duration-200 shadow-sm placeholder-gray-400",rows:2,value:s[t].description,onChange:a=>y(t,"description",a.target.value),required:!0})]},t))})]})]}),e.jsx("div",{className:"flex justify-center mt-8",children:l?e.jsx("button",{type:"button",onClick:V,className:"w-full max-w-md bg-blue-700 hover:bg-blue-800 text-white font-bold py-4 px-10 rounded-2xl shadow-lg transition-all duration-200 text-xl tracking-wide border-2 border-blue-900",children:"Update Blog"}):e.jsx("button",{type:"submit",className:"w-full max-w-md bg-blue-700 hover:bg-blue-800 text-white font-bold py-4 px-10 rounded-2xl shadow-lg transition-all duration-200 text-xl tracking-wide border-2 border-blue-900",children:"Submit Blog"})})]})]})]})};export{ee as default};
