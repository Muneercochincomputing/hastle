import{d as H,u as W,r as n,j as e}from"./index-BE44N7L4.js";import{G as q}from"./iconBase-DVlQWJQE.js";function V(c){return q({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},child:[]}]})(c)}function k(c){return q({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"16 16 12 12 8 16"},child:[]},{tag:"line",attr:{x1:"12",y1:"12",x2:"12",y2:"21"},child:[]},{tag:"path",attr:{d:"M20.39 18.39A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.3"},child:[]},{tag:"polyline",attr:{points:"16 16 12 12 8 16"},child:[]}]})(c)}const Y=()=>{var E;const c=H();W();const[l,C]=n.useState(((E=c.state)==null?void 0:E.editId)||null),[y,m]=n.useState(""),[g,b]=n.useState(null),[j,x]=n.useState(null),[w,h]=n.useState(""),[v,p]=n.useState(""),[s,u]=n.useState([{subtitle:"",image:null,imagePreview:null,imageName:"",description:""},{subtitle:"",image:null,imagePreview:null,imageName:"",description:""},{subtitle:"",image:null,imagePreview:null,imageName:"",description:""}]),[U,J]=n.useState(!1),[B,K]=n.useState(null);n.useEffect(()=>{l||(m(""),p(""),b(null),x(null),h(""),u([{subtitle:"",image:null,imagePreview:null,imageName:"",description:""},{subtitle:"",image:null,imagePreview:null,imageName:"",description:""},{subtitle:"",image:null,imagePreview:null,imageName:"",description:""}]))},[l]);const A=a=>{C(a.id),m(a.mainTitle||""),p(a.mainDescription||""),h(""),x(a.mainImage||null),b(null),u([...[0,1,2].map(t=>{var i,r,o,L,T,M;return{subtitle:((r=(i=a.subSections)==null?void 0:i[t])==null?void 0:r.title)||"",image:null,imagePreview:((L=(o=a.subSections)==null?void 0:o[t])==null?void 0:L.image)||null,imageName:"",description:((M=(T=a.subSections)==null?void 0:T[t])==null?void 0:M.description)||""}})])},[N,P]=n.useState(!0),[I,F]=n.useState({}),[O,S]=n.useState(!1);n.useEffect(()=>{N&&(S(!0),fetch("/getbloglist").then(a=>a.json()).then(a=>{const i={"Latest Blogs":a.slice(0,4)};F(i),S(!1)}).catch(()=>S(!1)))},[N]);const R=a=>{const t=a.target.files[0];t&&(b(t),x(URL.createObjectURL(t)),h(t.name))},f=(a,t,i)=>{u(r=>{const o=[...r];return o[a][t]=i,o})},D=(a,t)=>{const i=t.target.files[0];i&&u(r=>{const o=[...r];return o[a].image=i,o[a].imagePreview=URL.createObjectURL(i),o[a].imageName=i.name,o})},[$,d]=n.useState(!1),G=async a=>{a.preventDefault(),d(!0);try{console.log("Submitting new blog.");const t=new FormData;t.append("mainTitle",y),t.append("mainDescription",v),g&&t.append("mainImage",g),t.append("subTitle1",s[0].subtitle),t.append("subDescription1",s[0].description),s[0].image&&t.append("subImage1",s[0].image),t.append("subTitle2",s[1].subtitle),t.append("subDescription2",s[1].description),s[1].image&&t.append("subImage2",s[1].image),t.append("subTitle3",s[2].subtitle),t.append("subDescription3",s[2].description),s[2].image&&t.append("subImage3",s[2].image);const i=await fetch("/insertBlogContent",{method:"POST",body:t});if(!i.ok){const r=await i.text();throw console.error("Blog submit failed:",r),new Error(r||"Failed to submit blog")}alert("Blog submitted successfully!"),d(!1)}catch(t){d(!1),console.error("Error submitting blog:",t),alert("Error submitting blog: "+t.message)}},z=async a=>{a.preventDefault(),d(!0);try{if(!l)return;console.log("Submitting edited blog.");const t=new FormData;t.append("mainTitle",y),t.append("mainDescription",v),g&&t.append("mainImage",g),t.append("subTitle1",s[0].subtitle),t.append("subDescription1",s[0].description),s[0].image&&t.append("subImage1",s[0].image),t.append("subTitle2",s[1].subtitle),t.append("subDescription2",s[1].description),s[1].image&&t.append("subImage2",s[1].image),t.append("subTitle3",s[2].subtitle),t.append("subDescription3",s[2].description),s[2].image&&t.append("subImage3",s[2].image);const i=await fetch(`/blog/${l}`,{method:"PUT",body:t});if(!i.ok){const r=await i.text();throw console.error("Blog edit failed:",r),new Error(r||"Failed to update blog")}alert("Blog updated successfully!"),d(!1)}catch(t){d(!1),console.error("Error editing blog:",t),alert("Error editing blog: "+t.message)}};return l&&U?e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center text-white text-xl",children:"Loading blog for editing..."}):l&&B?e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center text-red-400 text-xl",children:B}):e.jsxs("div",{className:"min-h-screen bg-gray-900 py-8 w-full relative",children:[$&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("svg",{className:"animate-spin h-16 w-16 text-blue-400 mb-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),e.jsx("div",{className:"text-white text-xl font-bold",children:"Please wait..."})]})}),e.jsxs("div",{className:"w-full bg-gray-800 rounded-2xl shadow-xl p-10 border border-gray-700 animate-fade-in",children:[e.jsx("div",{className:"flex justify-center mb-8",children:e.jsxs("div",{className:"flex rounded-xl overflow-hidden border-2 border-blue-700 bg-gray-900",children:[e.jsx("button",{type:"button",className:`px-8 py-3 font-bold text-lg transition-all duration-200 focus:outline-none ${l?"bg-gray-900 text-blue-300 hover:bg-blue-800 hover:text-white":"bg-blue-700 text-white"}`,disabled:!l,onClick:()=>{P(!1),C(null),m(""),p(""),b(null),x(null),h(""),u([{subtitle:"",image:null,imagePreview:null,imageName:"",description:""},{subtitle:"",image:null,imagePreview:null,imageName:"",description:""},{subtitle:"",image:null,imagePreview:null,imageName:"",description:""}])},children:"Add Blog"}),e.jsx("button",{type:"button",className:`px-8 py-3 font-bold text-lg transition-all duration-200 focus:outline-none ${l?"bg-blue-700 text-white":"bg-gray-900 text-blue-300 hover:bg-blue-800 hover:text-white"}`,disabled:!!l,onClick:()=>P(a=>!a),children:"Edit Blog"})]})}),N&&e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"bg-gray-700 rounded-xl p-6 shadow border border-blue-700",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Uploaded Blogs"}),O?e.jsx("div",{className:"text-gray-300",children:"Loading blogs..."}):Object.keys(I).length===0?e.jsx("div",{className:"text-gray-400",children:"No blogs found."}):Object.entries(I).map(([a,t])=>e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"font-bold text-lg text-blue-300 mb-2",children:a}),e.jsx("ul",{className:"space-y-2",children:t.map(i=>{var r;return e.jsxs("li",{className:"bg-white rounded-lg shadow p-4 flex items-center justify-between border border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-base",children:i.mainTitle}),e.jsxs("div",{className:"text-gray-500 text-xs line-clamp-1",children:[(r=i.mainDescription)==null?void 0:r.slice(0,80),"..."]})]}),e.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-bold ml-4",onClick:()=>A(i),children:"Edit"})]},i.id)})})]},a)),e.jsx("div",{className:"text-xs text-gray-400 mt-2",children:"Click 'Edit' on a blog to load it for editing."})]})}),e.jsx("div",{className:"flex items-center justify-center mb-8",children:e.jsx("span",{className:"bg-gradient-to-r from-blue-700 to-blue-400 p-4 rounded-full shadow",children:e.jsx(V,{className:"text-4xl text-white"})})}),e.jsx("h2",{className:"text-3xl font-bold text-center text-white mb-2 tracking-tight font-serif",children:l?"Edit Blog":"Add New Blog"}),e.jsx("p",{className:"text-center text-gray-300 mb-8 font-normal",children:l?"Update the details below to edit the blog post.":"Fill in the details below to create a new blog post."}),e.jsxs("form",{onSubmit:G,className:"",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10",children:[e.jsxs("div",{className:"flex flex-col gap-8 justify-start",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-2 text-gray-200",children:"Main Title"}),e.jsx("input",{type:"text",className:"w-full border border-gray-700 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-600 bg-gray-700 text-white transition-all duration-200 shadow-sm placeholder-gray-400",value:y,onChange:a=>m(a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-2 text-gray-200",children:"Main Image"}),e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-gray-600 rounded-xl cursor-pointer bg-gray-900 hover:bg-gray-800 transition group",children:[e.jsx(k,{className:"text-3xl text-blue-400 mb-2 group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-gray-400 font-medium",children:"Click to upload"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:R,required:!l})]}),w&&e.jsxs("div",{className:"mt-2 text-sm text-gray-400",children:["Selected: ",e.jsx("span",{className:"font-semibold text-gray-200",children:w})]}),!w&&j&&l&&e.jsx("div",{className:"mt-2 text-sm text-gray-400",children:"Current image in use"}),j&&e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx("div",{className:"rounded-xl overflow-hidden shadow border border-gray-700 bg-gray-900 w-60",children:e.jsx("img",{src:j,alt:"Main Preview",className:"h-40 w-full object-cover hover:scale-105 transition-transform duration-300"})})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-2 text-gray-200",children:"Main Description"}),e.jsx("textarea",{className:"w-full border border-gray-700 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-600 bg-gray-700 text-white transition-all duration-200 shadow-sm placeholder-gray-400",rows:4,value:v,onChange:a=>p(a.target.value),required:!0})]})]}),e.jsxs("div",{className:"flex flex-col gap-8 justify-start",children:[e.jsxs("div",{className:"bg-gray-800 rounded-2xl p-6 shadow border border-gray-700 animate-fade-in-up",children:[e.jsx("h3",{className:"font-semibold mb-3 text-lg text-white font-serif",children:"Subtitle 1"}),e.jsx("input",{type:"text",className:"w-full border border-gray-700 rounded-lg px-3 py-2 mb-3 focus:outline-none focus:ring-2 focus:ring-blue-600 bg-gray-700 text-white transition-all duration-200 shadow-sm placeholder-gray-400",placeholder:"Subtitle 1",value:s[0].subtitle,onChange:a=>f(0,"subtitle",a.target.value),required:!0}),e.jsx("label",{className:"block font-semibold mb-2 text-gray-200",children:"Subtitle Image"}),e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-28 border-2 border-dashed border-gray-600 rounded-xl cursor-pointer bg-gray-900 hover:bg-gray-800 transition group",children:[e.jsx(k,{className:"text-2xl text-blue-400 mb-1 group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-gray-400 font-medium text-sm",children:"Click to upload"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:a=>D(0,a),required:!l})]}),s[0].imageName&&e.jsxs("div",{className:"mt-1 text-xs text-gray-400",children:["Selected: ",e.jsx("span",{className:"font-semibold text-gray-200",children:s[0].imageName})]}),!s[0].imageName&&s[0].imagePreview&&l&&e.jsx("div",{className:"mt-1 text-xs text-gray-400",children:"Current image in use"}),s[0].imagePreview&&e.jsx("div",{className:"mt-3 flex justify-center",children:e.jsx("div",{className:"rounded-lg overflow-hidden shadow border border-gray-700 bg-gray-900 w-44",children:e.jsx("img",{src:s[0].imagePreview,alt:"Subtitle 1 Preview",className:"h-28 w-full object-cover hover:scale-105 transition-transform duration-300"})})}),e.jsx("label",{className:"block font-semibold mb-2 text-gray-200 mt-3",children:"Subtitle Description"}),e.jsx("textarea",{className:"w-full border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 bg-gray-700 text-white transition-all duration-200 shadow-sm placeholder-gray-400",rows:2,value:s[0].description,onChange:a=>f(0,"description",a.target.value),required:!0})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[1,2].map(a=>e.jsxs("div",{className:"bg-gray-800 rounded-2xl p-6 shadow border border-gray-700 animate-fade-in-up",children:[e.jsxs("h3",{className:"font-semibold mb-3 text-lg text-white font-serif",children:["Subtitle ",a+1]}),e.jsx("input",{type:"text",className:"w-full border border-gray-700 rounded-lg px-3 py-2 mb-3 focus:outline-none focus:ring-2 focus:ring-blue-600 bg-gray-700 text-white transition-all duration-200 shadow-sm placeholder-gray-400",placeholder:`Subtitle ${a+1}`,value:s[a].subtitle,onChange:t=>f(a,"subtitle",t.target.value),required:!0}),e.jsx("label",{className:"block font-semibold mb-2 text-gray-200",children:"Subtitle Image"}),e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-28 border-2 border-dashed border-gray-600 rounded-xl cursor-pointer bg-gray-900 hover:bg-gray-800 transition group",children:[e.jsx(k,{className:"text-2xl text-blue-400 mb-1 group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-gray-400 font-medium text-sm",children:"Click to upload"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:t=>D(a,t),required:!l})]}),s[a].imageName&&e.jsxs("div",{className:"mt-1 text-xs text-gray-400",children:["Selected: ",e.jsx("span",{className:"font-semibold text-gray-200",children:s[a].imageName})]}),!s[a].imageName&&s[a].imagePreview&&l&&e.jsx("div",{className:"mt-1 text-xs text-gray-400",children:"Current image in use"}),s[a].imagePreview&&e.jsx("div",{className:"mt-3 flex justify-center",children:e.jsx("div",{className:"rounded-lg overflow-hidden shadow border border-gray-700 bg-gray-900 w-44",children:e.jsx("img",{src:s[a].imagePreview,alt:`Subtitle ${a+1} Preview`,className:"h-28 w-full object-cover hover:scale-105 transition-transform duration-300"})})}),e.jsx("label",{className:"block font-semibold mb-2 text-gray-200 mt-3",children:"Subtitle Description"}),e.jsx("textarea",{className:"w-full border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600 bg-gray-700 text-white transition-all duration-200 shadow-sm placeholder-gray-400",rows:2,value:s[a].description,onChange:t=>f(a,"description",t.target.value),required:!0})]},a))})]})]}),e.jsx("div",{className:"flex justify-center mt-8",children:l?e.jsx("button",{type:"button",onClick:z,className:"w-full max-w-md bg-blue-700 hover:bg-blue-800 text-white font-bold py-4 px-10 rounded-2xl shadow-lg transition-all duration-200 text-xl tracking-wide border-2 border-blue-900",children:"Update Blog"}):e.jsx("button",{type:"submit",className:"w-full max-w-md bg-blue-700 hover:bg-blue-800 text-white font-bold py-4 px-10 rounded-2xl shadow-lg transition-all duration-200 text-xl tracking-wide border-2 border-blue-900",children:"Submit Blog"})})]})]})]})};export{Y as default};
